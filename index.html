<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSK1 Mandarin Companion</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #fecaca 0%, #fed7aa 50%, #fef3c7 100%);
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 64rem;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            padding-top: 5rem;
        }

        .flag-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translate(-50%, -2rem);
        }

        .flag {
            width: 5rem;
            height: 3.5rem;
            background: #dc2626;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid #fbbf24;
            position: relative;
        }

        .flag::after {
            content: '‚≠ê';
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            color: #fbbf24;
            font-size: 1rem;
        }

        .stars {
            position: absolute;
            top: 0.25rem;
            left: 2rem;
            color: #fbbf24;
            font-size: 0.75rem;
            line-height: 0.75rem;
        }

        .flag-emoji {
            font-size: 2.5rem;
            margin-top: 0.5rem;
        }

        .title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #dc2626, #ea580c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.125rem;
            color: #374151;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .emoji-row {
            display: flex;
            justify-content: center;
            gap: 1rem;
            font-size: 1.5rem;
        }

        .nav {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .nav-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .nav-button:hover {
            transform: scale(1.05);
        }

        .nav-button.active {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            color: white;
        }

        .nav-button:not(.active) {
            background: white;
            color: #374151;
        }

        .progress-stats {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            text-align: center;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #6b7280;
        }

        .category-filter {
            margin-bottom: 1rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }

        .category-button {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-button.active {
            background: #1f2937;
            color: white;
        }

        .category-button:not(.active) {
            background: #e5e7eb;
            color: #374151;
        }

        .card-container {
            max-width: 28rem;
            margin: 0 auto;
        }

        .flashcard {
            background: linear-gradient(135deg, white, #dbeafe);
            border-radius: 1rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            padding: 2rem;
            min-height: 20rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 4px solid #bfdbfe;
            position: relative;
            overflow: hidden;
        }

        .flashcard.mastered {
            border-color: #86efac;
            background: linear-gradient(135deg, #dcfce7, #dbeafe);
        }

        .card-bg-emoji {
            position: absolute;
            font-size: 4rem;
            opacity: 0.1;
            pointer-events: none;
        }

        .card-bg-emoji.top-right {
            top: 0;
            right: 0;
            transform: rotate(12deg);
        }

        .card-bg-emoji.bottom-left {
            bottom: 0;
            left: 0;
            font-size: 2.5rem;
        }

        .mastery-star {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            color: #10b981;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .card-content {
            text-align: center;
            margin-bottom: 1.5rem;
            z-index: 10;
            position: relative;
        }

        .chinese-text {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #1f2937;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .pinyin-text {
            font-size: 1.25rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
            background: #fef3c7;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
        }

        .tone-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.25rem;
            background: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 0.5rem;
        }

        .category-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .answer-section {
            text-align: center;
            animation: bounce 0.5s;
            z-index: 10;
            position: relative;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .answer-text {
            font-size: 1.875rem;
            font-weight: 600;
            color: #059669;
            margin-bottom: 0.5rem;
            background: #dcfce7;
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .tone-info {
            font-size: 0.875rem;
            color: #6b7280;
            background: #f3f4f6;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
        }

        .control-button {
            padding: 1rem;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .control-button:hover {
            transform: scale(1.1);
        }

        .nav-control {
            background: linear-gradient(to right, #a855f7, #8b5cf6);
            color: white;
        }

        .center-controls {
            display: flex;
            gap: 0.5rem;
        }

        .action-button {
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .action-button:hover {
            transform: scale(1.05);
        }

        .show-button {
            background: linear-gradient(to right, #3b82f6, #4f46e5);
            color: white;
        }

        .master-button {
            background: linear-gradient(to right, #10b981, #059669);
            color: white;
        }

        .flip-button {
            background: linear-gradient(to right, #8b5cf6, #ec4899);
            color: white;
            padding: 0.75rem 1rem;
        }

        .progress-info {
            text-align: center;
            margin-top: 1rem;
        }

        .progress-card {
            background: white;
            border-radius: 9999px;
            padding: 0.5rem 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 0.5rem;
        }

        .progress-text {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
        }

        .progress-bar-container {
            width: 100%;
            background: #e5e7eb;
            border-radius: 9999px;
            height: 0.5rem;
            margin-top: 0.5rem;
        }

        .progress-bar {
            background: linear-gradient(to right, #60a5fa, #8b5cf6);
            height: 0.5rem;
            border-radius: 9999px;
            transition: all 0.3s;
        }

        .shuffle-button {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .shuffle-button.shuffled {
            background: #10b981;
            color: white;
        }

        .shuffle-button:not(.shuffled) {
            background: #e5e7eb;
            color: #374151;
        }

        .tone-practice {
            background: linear-gradient(135deg, white, #dcfce7);
            border: 4px solid #86efac;
        }

        .tone-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            z-index: 10;
            position: relative;
        }

        .tone-button {
            padding: 1rem;
            border-radius: 1rem;
            border: 3px solid #d1d5db;
            background: linear-gradient(135deg, white, #f9fafb);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .tone-button:hover:not(:disabled) {
            transform: scale(1.05);
            border-color: #9ca3af;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
        }

        .tone-button.correct {
            border-color: #10b981;
            background: linear-gradient(135deg, #dcfce7, #d1fae5);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        .tone-button.incorrect {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }

        .tone-number {
            font-size: 1.125rem;
            font-weight: bold;
        }

        .tone-desc {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .tone-symbol {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }

        .score-display {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            margin-top: 1rem;
        }

        .score-text {
            font-size: 1.125rem;
            font-weight: bold;
            color: #374151;
        }

        .streak-text {
            font-size: 0.875rem;
            color: #ea580c;
            margin-top: 0.25rem;
        }

        .sentences-card {
            background: linear-gradient(135deg, white, #fff7ed);
            border: 4px solid #fed7aa;
        }

        .sentence-section {
            background: #fef2f2;
            padding: 1.5rem;
            border-radius: 1rem;
            margin-bottom: 1rem;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .sentence-section.pinyin {
            background: #fef3c7;
        }

        .sentence-section.english {
            background: #dbeafe;
        }

        .sentence-chinese {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .sentence-pinyin {
            font-size: 1.5rem;
            color: #6b7280;
        }

        .sentence-english {
            font-size: 1.25rem;
            color: #374151;
        }

        .tone-guide {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 42rem;
            margin: 0 auto;
        }

        .guide-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .tone-entry {
            border-left: 4px solid;
            padding-left: 1rem;
            margin-bottom: 1.5rem;
        }

        .tone-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .tone-symbol-large {
            font-size: 1.875rem;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .tone-name {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .tone-number-small {
            margin-left: 0.5rem;
            font-size: 1.125rem;
        }

        .tone-description {
            color: #6b7280;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .tone-example {
            font-size: 0.875rem;
            color: #9ca3af;
        }

        .pro-tips {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(to right, #dbeafe, #e0e7ff);
            border-radius: 0.5rem;
            border-left: 4px solid #3b82f6;
        }

        .tips-title {
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
        }

        .tips-list {
            font-size: 0.875rem;
            color: #1d4ed8;
            list-style: none;
            padding: 0;
        }

        .tips-list li {
            margin-bottom: 0.5rem;
        }

        .practice-tip {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #fefce8;
            border-radius: 0.5rem;
            border: 1px solid #fde047;
        }

        .practice-title {
            font-weight: 600;
            color: #a16207;
            margin-bottom: 0.5rem;
        }

        .practice-text {
            font-size: 0.875rem;
            color: #a16207;
        }

        .reset-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(to right, #6b7280, #4b5563);
            color: white;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            margin: 0 auto;
        }

        .reset-button:hover {
            transform: scale(1.05);
            background: linear-gradient(to right, #4b5563, #374151);
        }

        .footer {
            text-align: center;
            margin-top: 2rem;
            font-size: 0.875rem;
            color: #6b7280;
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .footer-main {
            font-weight: 600;
        }

        .footer-encouragement {
            margin-top: 0.5rem;
        }

        .footer-tip {
            margin-top: 0.75rem;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        /* Color classes for tones */
        .tone-1 { color: #ef4444; }
        .tone-2 { color: #f97316; }
        .tone-3 { color: #10b981; }
        .tone-4 { color: #3b82f6; }
        .tone-0 { color: #6b7280; }

        /* Border colors for tone guide */
        .border-tone-1 { border-color: #ef4444; }
        .border-tone-2 { border-color: #f97316; }
        .border-tone-3 { border-color: #10b981; }
        .border-tone-4 { border-color: #3b82f6; }
        .border-tone-0 { border-color: #6b7280; }

        /* Category colors */
        .cat-greetings { background: #fce7f3; color: #be185d; }
        .cat-pronouns { background: #f3e8ff; color: #7c3aed; }
        .cat-verbs { background: #dbeafe; color: #1d4ed8; }
        .cat-adjectives { background: #dcfce7; color: #059669; }
        .cat-numbers { background: #fef3c7; color: #d97706; }
        .cat-time { background: #e0e7ff; color: #4338ca; }
        .cat-food { background: #fed7aa; color: #ea580c; }
        .cat-places { background: #ccfbf1; color: #0f766e; }
        .cat-transport { background: #cffafe; color: #0e7490; }
        .cat-people { background: #fecaca; color: #dc2626; }
        .cat-objects { background: #f3f4f6; color: #374151; }
        .cat-electronics { background: #ede9fe; color: #7c2d12; }
        .cat-entertainment { background: #fce7f3; color: #be185d; }
        .cat-shopping { background: #ecfccb; color: #65a30d; }
        .cat-activities { background: #fef3c7; color: #d97706; }
        .cat-questions { background: #e0f2fe; color: #0284c7; }
        .cat-particles { background: #d1fae5; color: #059669; }
        .cat-prepositions { background: #fae8ff; color: #c026d3; }
        .cat-basic { background: #f1f5f9; color: #475569; }

        .hidden { display: none; }

        @media (max-width: 768px) {
            .title { font-size: 2rem; }
            .chinese-text { font-size: 2rem; }
            .sentence-chinese { font-size: 1.75rem; }
            .nav { gap: 0.25rem; }
            .nav-button { padding: 0.5rem 1rem; font-size: 0.875rem; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="flag-container">
                <div class="flag">
                    <div class="stars">
                        ‚òÖ<br>‚òÖ<br>‚òÖ<br>‚òÖ
                    </div>
                </div>
                <div class="flag-emoji">üá®üá≥</div>
            </div>
            <h1 class="title">HSK1 Mandarin Companion</h1>
            <p class="subtitle">üéØ Build your foundation for diplomatic communication üåü</p>
            <div class="emoji-row">
                <span>üìö</span><span>üó£Ô∏è</span><span>üéµ</span><span>‚ú®</span>
            </div>
        </header>
        
        <nav class="nav">
            <button class="nav-button active" onclick="setMode('flashcards')">
                <span>üìö</span>
                <span>üìñ</span>
                <span>Flashcards</span>
            </button>
            <button class="nav-button" onclick="setMode('tones')">
                <span>üéµ</span>
                <span>üéØ</span>
                <span>Tone Practice</span>
            </button>
            <button class="nav-button" onclick="setMode('sentences')">
                <span>üí¨</span>
                <span>üîä</span>
                <span>Sentences</span>
            </button>
            <button class="nav-button" onclick="setMode('guide')">
                <span>üèÜ</span>
                <span>üìã</span>
                <span>Tone Guide</span>
            </button>
        </nav>
        
        <main id="main-content">
            <!-- Content will be dynamically inserted here -->
        </main>
        
        <div style="text-align: center;">
            <button class="reset-button" onclick="resetProgress()">
                <span>üîÑ</span>
                <span>Reset Progress</span>
            </button>
        </div>
        
        <footer class="footer">
            <p class="footer-main">HSK1 covers ~150 words. Master these fundamentals first!</p>
            <p class="footer-encouragement">Good luck with your diplomatic language journey! <strong style="color: #dc2626;">Âä†Ê≤πÔºÅ</strong> (jiƒÅ y√≥u - keep going!)</p>
            <div class="footer-tip">
                üí° Tip: Use spaced repetition - review difficult words more frequently!
            </div>
        </footer>
    </div>

    <script>
        // HSK1 Vocabulary Data
        const HSK1_VOCABULARY = [
            { chinese: '‰Ω†Â•Ω', pinyin: 'n«ê h«éo', english: 'hello', tone: [3, 3], category: 'greetings' },
            { chinese: 'Êàë', pinyin: 'w«í', english: 'I/me', tone: [3], category: 'pronouns' },
            { chinese: '‰Ω†', pinyin: 'n«ê', english: 'you', tone: [3], category: 'pronouns' },
            { chinese: '‰ªñ', pinyin: 'tƒÅ', english: 'he/him', tone: [1], category: 'pronouns' },
            { chinese: 'Â•π', pinyin: 'tƒÅ', english: 'she/her', tone: [1], category: 'pronouns' },
            { chinese: 'ÊòØ', pinyin: 'sh√¨', english: 'to be', tone: [4], category: 'verbs' },
            { chinese: '‰∏ç', pinyin: 'b√π', english: 'not', tone: [4], category: 'particles' },
            { chinese: 'ÁöÑ', pinyin: 'de', english: 'possessive particle', tone: [0], category: 'particles' },
            { chinese: 'Êúâ', pinyin: 'y«íu', english: 'to have', tone: [3], category: 'verbs' },
            { chinese: 'Âú®', pinyin: 'z√†i', english: 'at/in', tone: [4], category: 'prepositions' },
            { chinese: '‰∫∫', pinyin: 'r√©n', english: 'person', tone: [2], category: 'people' },
            { chinese: '‰∏≠ÂõΩ', pinyin: 'zh≈çng gu√≥', english: 'China', tone: [1, 2], category: 'places' },
            { chinese: 'ËÄÅÂ∏à', pinyin: 'l«éo shƒ´', english: 'teacher', tone: [3, 1], category: 'people' },
            { chinese: 'Â≠¶Áîü', pinyin: 'xu√© shƒìng', english: 'student', tone: [2, 1], category: 'people' },
            { chinese: 'ÊúãÂèã', pinyin: 'p√©ng y«íu', english: 'friend', tone: [2, 3], category: 'people' },
            { chinese: 'ÂÆ∂', pinyin: 'jiƒÅ', english: 'home/family', tone: [1], category: 'places' },
            { chinese: 'Â≠¶Ê†°', pinyin: 'xu√© xi√†o', english: 'school', tone: [2, 4], category: 'places' },
            { chinese: 'Â∑•‰Ωú', pinyin: 'g≈çng zu√≤', english: 'work', tone: [1, 4], category: 'activities' },
            { chinese: '‰ªäÂ§©', pinyin: 'jƒ´n tiƒÅn', english: 'today', tone: [1, 1], category: 'time' },
            { chinese: 'ÊòéÂ§©', pinyin: 'm√≠ng tiƒÅn', english: 'tomorrow', tone: [2, 1], category: 'time' },
            { chinese: 'Êò®Â§©', pinyin: 'zu√≥ tiƒÅn', english: 'yesterday', tone: [2, 1], category: 'time' },
            { chinese: 'Áé∞Âú®', pinyin: 'xi√†n z√†i', english: 'now', tone: [4, 4], category: 'time' },
            { chinese: 'Êó∂Èó¥', pinyin: 'sh√≠ jiƒÅn', english: 'time', tone: [2, 1], category: 'time' },
            { chinese: 'Âπ¥', pinyin: 'ni√°n', english: 'year', tone: [2], category: 'time' },
            { chinese: 'Êúà', pinyin: 'yu√®', english: 'month', tone: [4], category: 'time' },
            { chinese: 'Êó•', pinyin: 'r√¨', english: 'day', tone: [4], category: 'time' },
            { chinese: 'ÊòüÊúü', pinyin: 'xƒ´ng qƒ´', english: 'week', tone: [1, 1], category: 'time' },
            { chinese: 'ÂêçÂ≠ó', pinyin: 'm√≠ng zi', english: 'name', tone: [2, 0], category: 'basic' },
            { chinese: '‰ªÄ‰πà', pinyin: 'sh√©n me', english: 'what', tone: [2, 0], category: 'questions' },
            { chinese: 'Âì™Èáå', pinyin: 'n«é l«ê', english: 'where', tone: [3, 3], category: 'questions' },
            { chinese: 'Ë∞Å', pinyin: 'sh√©i', english: 'who', tone: [2], category: 'questions' },
            { chinese: 'Â§öÂ∞ë', pinyin: 'du≈ç shao', english: 'how much/many', tone: [1, 0], category: 'questions' },
            { chinese: 'Âá†', pinyin: 'j«ê', english: 'how many (small number)', tone: [3], category: 'questions' },
            { chinese: 'ÊÄé‰πà', pinyin: 'zƒõn me', english: 'how', tone: [3, 0], category: 'questions' },
            { chinese: '‰∏∫‰ªÄ‰πà', pinyin: 'w√®i sh√©n me', english: 'why', tone: [4, 2, 0], category: 'questions' },
            { chinese: 'Ê∞¥', pinyin: 'shu«ê', english: 'water', tone: [3], category: 'food' },
            { chinese: 'Ëå∂', pinyin: 'ch√°', english: 'tea', tone: [2], category: 'food' },
            { chinese: 'ÂíñÂï°', pinyin: 'kƒÅ fƒìi', english: 'coffee', tone: [1, 1], category: 'food' },
            { chinese: 'ÁâõÂ•∂', pinyin: 'ni√∫ n«éi', english: 'milk', tone: [2, 3], category: 'food' },
            { chinese: 'Èù¢ÂåÖ', pinyin: 'mi√†n bƒÅo', english: 'bread', tone: [4, 1], category: 'food' },
            { chinese: 'Á±≥È•≠', pinyin: 'm«ê f√†n', english: 'rice', tone: [3, 4], category: 'food' },
            { chinese: 'Èù¢Êù°', pinyin: 'mi√†n ti√°o', english: 'noodles', tone: [4, 2], category: 'food' },
            { chinese: 'Ëèú', pinyin: 'c√†i', english: 'dish/vegetable', tone: [4], category: 'food' },
            { chinese: 'Ê∞¥Êûú', pinyin: 'shu«ê gu«í', english: 'fruit', tone: [3, 3], category: 'food' },
            { chinese: 'ËãπÊûú', pinyin: 'p√≠ng gu«í', english: 'apple', tone: [2, 3], category: 'food' },
            { chinese: 'È¶ôËïâ', pinyin: 'xiƒÅng jiƒÅo', english: 'banana', tone: [1, 1], category: 'food' },
            { chinese: 'Èí±', pinyin: 'qi√°n', english: 'money', tone: [2], category: 'shopping' },
            { chinese: '‰π∞', pinyin: 'm«éi', english: 'to buy', tone: [3], category: 'verbs' },
            { chinese: 'Âçñ', pinyin: 'm√†i', english: 'to sell', tone: [4], category: 'verbs' },
            { chinese: 'ÂêÉ', pinyin: 'chƒ´', english: 'to eat', tone: [1], category: 'verbs' },
            { chinese: 'Âñù', pinyin: 'hƒì', english: 'to drink', tone: [1], category: 'verbs' },
            { chinese: 'Áúã', pinyin: 'k√†n', english: 'to look/watch', tone: [4], category: 'verbs' },
            { chinese: 'Âê¨', pinyin: 'tƒ´ng', english: 'to listen', tone: [1], category: 'verbs' },
            { chinese: 'ËØ¥', pinyin: 'shu≈ç', english: 'to speak', tone: [1], category: 'verbs' },
            { chinese: 'ËØª', pinyin: 'd√∫', english: 'to read', tone: [2], category: 'verbs' },
            { chinese: 'ÂÜô', pinyin: 'xiƒõ', english: 'to write', tone: [3], category: 'verbs' },
            { chinese: 'Â≠¶', pinyin: 'xu√©', english: 'to study/learn', tone: [2], category: 'verbs' },
            { chinese: 'Êïô', pinyin: 'jiƒÅo', english: 'to teach', tone: [1], category: 'verbs' },
            { chinese: 'Âéª', pinyin: 'q√π', english: 'to go', tone: [4], category: 'verbs' },
            { chinese: 'Êù•', pinyin: 'l√°i', english: 'to come', tone: [2], category: 'verbs' },
            { chinese: 'Âõû', pinyin: 'hu√≠', english: 'to return', tone: [2], category: 'verbs' },
            { chinese: 'Ëµ∞', pinyin: 'z«íu', english: 'to walk/leave', tone: [3], category: 'verbs' },
            { chinese: 'Âùê', pinyin: 'zu√≤', english: 'to sit', tone: [4], category: 'verbs' },
            { chinese: 'Á´ô', pinyin: 'zh√†n', english: 'to stand', tone: [4], category: 'verbs' },
            { chinese: 'Áù°Ëßâ', pinyin: 'shu√¨ ji√†o', english: 'to sleep', tone: [4, 4], category: 'activities' },
            { chinese: 'Ëµ∑Â∫ä', pinyin: 'q«ê chu√°ng', english: 'to get up', tone: [3, 2], category: 'activities' },
            { chinese: 'Ê¥óÊæ°', pinyin: 'x«ê z«éo', english: 'to take a bath', tone: [3, 3], category: 'activities' },
            { chinese: '‰π¶', pinyin: 'sh≈´', english: 'book', tone: [1], category: 'objects' },
            { chinese: 'Ê°åÂ≠ê', pinyin: 'zhu≈ç zi', english: 'table', tone: [1, 0], category: 'objects' },
            { chinese: 'Ê§ÖÂ≠ê', pinyin: 'y«ê zi', english: 'chair', tone: [3, 0], category: 'objects' },
            { chinese: 'ÊàøÈó¥', pinyin: 'f√°ng jiƒÅn', english: 'room', tone: [2, 1], category: 'places' },
            { chinese: 'ÂéïÊâÄ', pinyin: 'c√® su«í', english: 'toilet', tone: [4, 3], category: 'places' },
            { chinese: 'Èó®', pinyin: 'm√©n', english: 'door', tone: [2], category: 'objects' },
            { chinese: 'Á™óÊà∑', pinyin: 'chuƒÅng hu', english: 'window', tone: [1, 0], category: 'objects' },
            { chinese: 'Â∫ä', pinyin: 'chu√°ng', english: 'bed', tone: [2], category: 'objects' },
            { chinese: 'ÁîµËßÜ', pinyin: 'di√†n sh√¨', english: 'television', tone: [4, 4], category: 'electronics' },
            { chinese: 'ÁîµËÑë', pinyin: 'di√†n n«éo', english: 'computer', tone: [4, 3], category: 'electronics' },
            { chinese: 'ÊâãÊú∫', pinyin: 'sh«íu jƒ´', english: 'mobile phone', tone: [3, 1], category: 'electronics' },
            { chinese: 'ÁîµÂΩ±', pinyin: 'di√†n y«êng', english: 'movie', tone: [4, 3], category: 'entertainment' },
            { chinese: 'Èü≥‰πê', pinyin: 'yƒ´n yu√®', english: 'music', tone: [1, 4], category: 'entertainment' },
            { chinese: 'Ê±ΩËΩ¶', pinyin: 'q√¨ chƒì', english: 'car', tone: [4, 1], category: 'transport' },
            { chinese: 'Âá∫ÁßüËΩ¶', pinyin: 'ch≈´ z≈´ chƒì', english: 'taxi', tone: [1, 1, 1], category: 'transport' },
            { chinese: 'ÂÖ¨ÂÖ±Ê±ΩËΩ¶', pinyin: 'g≈çng g√≤ng q√¨ chƒì', english: 'bus', tone: [1, 4, 4, 1], category: 'transport' },
            { chinese: 'ÁÅ´ËΩ¶', pinyin: 'hu«í chƒì', english: 'train', tone: [3, 1], category: 'transport' },
            { chinese: 'È£ûÊú∫', pinyin: 'fƒìi jƒ´', english: 'airplane', tone: [1, 1], category: 'transport' },
            { chinese: 'Ëá™Ë°åËΩ¶', pinyin: 'z√¨ x√≠ng chƒì', english: 'bicycle', tone: [4, 2, 1], category: 'transport' },
            { chinese: 'ÂåªÈô¢', pinyin: 'yƒ´ yu√†n', english: 'hospital', tone: [1, 4], category: 'places' },
            { chinese: 'ÂïÜÂ∫ó', pinyin: 'shƒÅng di√†n', english: 'shop', tone: [1, 4], category: 'places' },
            { chinese: 'Ë∂ÖÂ∏Ç', pinyin: 'chƒÅo sh√¨', english: 'supermarket', tone: [1, 4], category: 'places' },
            { chinese: 'È•≠Â∫ó', pinyin: 'f√†n di√†n', english: 'restaurant', tone: [4, 4], category: 'places' },
            { chinese: 'Èì∂Ë°å', pinyin: 'y√≠n h√°ng', english: 'bank', tone: [2, 2], category: 'places' },
            { chinese: 'ÈÇÆÂ±Ä', pinyin: 'y√≥u j√∫', english: 'post office', tone: [2, 2], category: 'places' },
            { chinese: 'ÁÅ´ËΩ¶Á´ô', pinyin: 'hu«í chƒì zh√†n', english: 'train station', tone: [3, 1, 4], category: 'places' },
            { chinese: 'Êú∫Âú∫', pinyin: 'jƒ´ ch«éng', english: 'airport', tone: [1, 3], category: 'places' },
            { chinese: 'Â§ß', pinyin: 'd√†', english: 'big', tone: [4], category: 'adjectives' },
            { chinese: 'Â∞è', pinyin: 'xi«éo', english: 'small', tone: [3], category: 'adjectives' },
            { chinese: 'Â§ö', pinyin: 'du≈ç', english: 'many/much', tone: [1], category: 'adjectives' },
            { chinese: 'Â∞ë', pinyin: 'sh«éo', english: 'few/little', tone: [3], category: 'adjectives' },
            { chinese: 'Â•Ω', pinyin: 'h«éo', english: 'good', tone: [3], category: 'adjectives' },
            { chinese: 'Âùè', pinyin: 'hu√†i', english: 'bad', tone: [4], category: 'adjectives' },
            { chinese: 'Êñ∞', pinyin: 'xƒ´n', english: 'new', tone: [1], category: 'adjectives' },
            { chinese: 'Êóß', pinyin: 'ji√π', english: 'old', tone: [4], category: 'adjectives' },
            { chinese: 'È´ò', pinyin: 'gƒÅo', english: 'tall/high', tone: [1], category: 'adjectives' },
            { chinese: 'ÁüÆ', pinyin: '«éi', english: 'short', tone: [3], category: 'adjectives' },
            { chinese: 'ËÉñ', pinyin: 'p√†ng', english: 'fat', tone: [4], category: 'adjectives' },
            { chinese: 'Áò¶', pinyin: 'sh√≤u', english: 'thin', tone: [4], category: 'adjectives' },
            { chinese: 'ÁÉ≠', pinyin: 'r√®', english: 'hot', tone: [4], category: 'adjectives' },
            { chinese: 'ÂÜ∑', pinyin: 'lƒõng', english: 'cold', tone: [3], category: 'adjectives' },
            { chinese: 'Âø´', pinyin: 'ku√†i', english: 'fast', tone: [4], category: 'adjectives' },
            { chinese: 'ÊÖ¢', pinyin: 'm√†n', english: 'slow', tone: [4], category: 'adjectives' },
            { chinese: 'Êó©', pinyin: 'z«éo', english: 'early', tone: [3], category: 'time' },
            { chinese: 'Êôö', pinyin: 'w«én', english: 'late', tone: [3], category: 'time' },
            { chinese: 'Âøô', pinyin: 'm√°ng', english: 'busy', tone: [2], category: 'adjectives' },
            { chinese: 'Á¥Ø', pinyin: 'l√®i', english: 'tired', tone: [4], category: 'adjectives' },
            { chinese: 'È´òÂÖ¥', pinyin: 'gƒÅo x√¨ng', english: 'happy', tone: [1, 4], category: 'adjectives' },
            { chinese: 'ÊºÇ‰∫Æ', pinyin: 'pi√†o liang', english: 'beautiful', tone: [4, 0], category: 'adjectives' },
            { chinese: 'ËÅ™Êòé', pinyin: 'c≈çng ming', english: 'smart', tone: [1, 0], category: 'adjectives' },
            { chinese: '‰∏Ä', pinyin: 'yƒ´', english: 'one', tone: [1], category: 'numbers' },
            { chinese: '‰∫å', pinyin: '√®r', english: 'two', tone: [4], category: 'numbers' },
            { chinese: '‰∏â', pinyin: 'sƒÅn', english: 'three', tone: [1], category: 'numbers' },
            { chinese: 'Âõõ', pinyin: 's√¨', english: 'four', tone: [4], category: 'numbers' },
            { chinese: '‰∫î', pinyin: 'w«î', english: 'five', tone: [3], category: 'numbers' },
            { chinese: 'ÂÖ≠', pinyin: 'li√π', english: 'six', tone: [4], category: 'numbers' },
            { chinese: '‰∏É', pinyin: 'qƒ´', english: 'seven', tone: [1], category: 'numbers' },
            { chinese: 'ÂÖ´', pinyin: 'bƒÅ', english: 'eight', tone: [1], category: 'numbers' },
            { chinese: '‰πù', pinyin: 'ji«î', english: 'nine', tone: [3], category: 'numbers' },
            { chinese: 'ÂçÅ', pinyin: 'sh√≠', english: 'ten', tone: [2], category: 'numbers' },
            { chinese: 'Áôæ', pinyin: 'b«éi', english: 'hundred', tone: [3], category: 'numbers' },
            { chinese: 'ÂçÉ', pinyin: 'qiƒÅn', english: 'thousand', tone: [1], category: 'numbers' },
            { chinese: '‰∏á', pinyin: 'w√†n', english: 'ten thousand', tone: [4], category: 'numbers' }
        ];

        const TONES = {
            1: { name: 'First Tone', description: 'High, flat', color: 'tone-1', symbol: '¬Ø' },
            2: { name: 'Second Tone', description: 'Rising', color: 'tone-2', symbol: '¬¥' },
            3: { name: 'Third Tone', description: 'Falling-rising', color: 'tone-3', symbol: 'Àá' },
            4: { name: 'Fourth Tone', description: 'Falling', color: 'tone-4', symbol: '`' },
            0: { name: 'Neutral Tone', description: 'Light, quick', color: 'tone-0', symbol: '¬∑' }
        };

        const CATEGORIES = {
            'greetings': { emoji: 'üëã', class: 'cat-greetings' },
            'pronouns': { emoji: 'üë§', class: 'cat-pronouns' },
            'verbs': { emoji: 'üèÉ', class: 'cat-verbs' },
            'adjectives': { emoji: '‚ú®', class: 'cat-adjectives' },
            'numbers': { emoji: 'üî¢', class: 'cat-numbers' },
            'time': { emoji: '‚è∞', class: 'cat-time' },
            'food': { emoji: 'üçΩÔ∏è', class: 'cat-food' },
            'places': { emoji: 'üè¢', class: 'cat-places' },
            'transport': { emoji: 'üöó', class: 'cat-transport' },
            'people': { emoji: 'üë•', class: 'cat-people' },
            'objects': { emoji: 'üì¶', class: 'cat-objects' },
            'electronics': { emoji: 'üíª', class: 'cat-electronics' },
            'entertainment': { emoji: 'üé≠', class: 'cat-entertainment' },
            'shopping': { emoji: 'üõí', class: 'cat-shopping' },
            'activities': { emoji: '‚ö°', class: 'cat-activities' },
            'questions': { emoji: '‚ùì', class: 'cat-questions' },
            'particles': { emoji: 'üîó', class: 'cat-particles' },
            'prepositions': { emoji: 'üìç', class: 'cat-prepositions' },
            'basic': { emoji: '‚≠ê', class: 'cat-basic' }
        };

        const BASIC_SENTENCES = [
            { chinese: 'ÊàëÊòØÂ≠¶Áîü„ÄÇ', pinyin: 'W«í sh√¨ xu√© shƒìng.', english: 'I am a student.' },
            { chinese: '‰Ω†Â•ΩÂêóÔºü', pinyin: 'N«ê h«éo ma?', english: 'How are you?' },
            { chinese: '‰ªñÊòØËÄÅÂ∏à„ÄÇ', pinyin: 'TƒÅ sh√¨ l«éo shƒ´.', english: 'He is a teacher.' },
            { chinese: 'ËøôÊòØÊàëÁöÑ‰π¶„ÄÇ', pinyin: 'Zh√® sh√¨ w«í de sh≈´.', english: 'This is my book.' },
            { chinese: '‰Ω†Âè´‰ªÄ‰πàÂêçÂ≠óÔºü', pinyin: 'N«ê ji√†o sh√©n me m√≠ng zi?', english: 'What is your name?' },
            { chinese: '‰ªäÂ§©ÊòüÊúüÂá†Ôºü', pinyin: 'Jƒ´n tiƒÅn xƒ´ng qƒ´ j«ê?', english: 'What day is today?' },
            { chinese: 'Áé∞Âú®Âá†ÁÇπÔºü', pinyin: 'Xi√†n z√†i j«ê di«én?', english: 'What time is it now?' },
            { chinese: 'ÊàëÊúâ‰∏Ä‰∏™ÊúãÂèã„ÄÇ', pinyin: 'W«í y«íu yƒ´ g√® p√©ng y«íu.', english: 'I have a friend.' },
            { chinese: 'ÊàëÂú®Â≠¶Ê†°„ÄÇ', pinyin: 'W«í z√†i xu√© xi√†o.', english: 'I am at school.' },
            { chinese: 'Ë∞¢Ë∞¢‰Ω†ÔºÅ', pinyin: 'Xi√® xi√® n«ê!', english: 'Thank you!' },
            { chinese: '‰∏çÂÆ¢Ê∞î„ÄÇ', pinyin: 'B√π k√® qi.', english: 'You\'re welcome.' },
            { chinese: 'ÂØπ‰∏çËµ∑„ÄÇ', pinyin: 'Du√¨ bu q«ê.', english: 'Sorry.' }
        ];

        // App State
        let state = {
            currentMode: 'flashcards',
            currentCard: 0,
            showAnswer: false,
            score: 0,
            totalAnswered: 0,
            currentSentence: 0,
            selectedTone: null,
            quizMode: 'chinese-to-english',
            selectedCategory: 'all',
            studyStreak: 0,
            masteredWords: new Set(),
            shuffledCards: [],
            isShuffled: false,
            studySession: { started: false, wordsStudied: 0, timeStarted: null }
        };

        // Initialize
        function init() {
            state.shuffledCards = Array.from({length: HSK1_VOCABULARY.length}, (_, i) => i);
            updateDisplay();
        }

        function setMode(mode) {
            state.currentMode = mode;
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.nav-button').classList.add('active');
            updateDisplay();
        }

        function updateDisplay() {
            const content = document.getElementById('main-content');
            
            switch(state.currentMode) {
                case 'flashcards':
                    content.innerHTML = renderFlashcards();
                    break;
                case 'tones':
                    content.innerHTML = renderTonePractice();
                    break;
                case 'sentences':
                    content.innerHTML = renderSentences();
                    break;
                case 'guide':
                    content.innerHTML = renderToneGuide();
                    break;
            }
        }

        function getFilteredVocab() {
            return state.selectedCategory === 'all' 
                ? HSK1_VOCABULARY 
                : HSK1_VOCABULARY.filter(word => word.category === state.selectedCategory);
        }

        function getCurrentWord() {
            const filtered = getFilteredVocab();
            if (state.selectedCategory === 'all') {
                return HSK1_VOCABULARY[state.isShuffled ? state.shuffledCards[state.currentCard] : state.currentCard];
            } else {
                return filtered[state.currentCard];
            }
        }

        function renderProgressStats() {
            const studyTime = state.studySession.timeStarted ? Math.floor((Date.now() - state.studySession.timeStarted) / 60000) : 0;
            const accuracy = state.totalAnswered > 0 ? Math.round((state.score / state.totalAnswered) * 100) : 0;
            
            return `
                <div class="progress-stats">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" style="color: #3b82f6;">${state.studySession.wordsStudied}</div>
                            <div class="stat-label">Words Studied</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" style="color: #10b981;">${state.masteredWords.size}</div>
                            <div class="stat-label">Mastered</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" style="color: #8b5cf6;">${accuracy}%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" style="color: #f97316;">${studyTime}m</div>
                            <div class="stat-label">Study Time</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCategoryFilter() {
            let html = '<div class="category-filter">';
            
            html += `<button class="category-button ${state.selectedCategory === 'all' ? 'active' : ''}" 
                     onclick="setCategory('all')">üåü All Categories</button>`;
            
            Object.entries(CATEGORIES).forEach(([category, info]) => {
                html += `<button class="category-button ${CATEGORIES[category].class} ${state.selectedCategory === category ? 'active' : ''}" 
                         onclick="setCategory('${category}')">${info.emoji} ${category.charAt(0).toUpperCase() + category.slice(1)}</button>`;
            });
            
            html += '</div>';
            return html;
        }

        function renderToneIndicator(tones) {
            return tones.map((tone, index) => 
                `<span class="${TONES[tone].color}">${tone === 0 ? '¬∑' : tone}${index < tones.length - 1 ? ' ' : ''}</span>`
            ).join('');
        }

        function renderFlashcards() {
            const currentWord = getCurrentWord();
            const filteredVocab = getFilteredVocab();
            const wordIndex = state.selectedCategory === 'all' 
                ? (state.isShuffled ? state.shuffledCards[state.currentCard] : state.currentCard)
                : HSK1_VOCABULARY.findIndex(w => w === currentWord);
            const isMastered = state.masteredWords.has(wordIndex);
            
            return `
                <div class="card-container">
                    ${renderProgressStats()}
                    ${renderCategoryFilter()}
                    
                    <div class="flashcard ${isMastered ? 'mastered' : ''}">
                        <div class="card-bg-emoji top-right">üìö</div>
                        <div class="card-bg-emoji bottom-left">‚ú®</div>
                        
                        ${isMastered ? '<div class="mastery-star">‚≠ê</div>' : ''}
                        
                        <div class="card-content">
                            <div class="chinese-text">
                                ${state.quizMode === 'chinese-to-english' ? currentWord.chinese : currentWord.english}
                            </div>
                            <div class="pinyin-text">${currentWord.pinyin}</div>
                            <div class="tone-indicator">
                                ${renderToneIndicator(currentWord.tone)}
                            </div>
                            <div class="category-tag ${CATEGORIES[currentWord.category].class}">
                                ${CATEGORIES[currentWord.category].emoji} ${currentWord.category}
                            </div>
                        </div>
                        
                        ${state.showAnswer ? `
                            <div class="answer-section">
                                <div class="answer-text">
                                    ${state.quizMode === 'chinese-to-english' ? currentWord.english : currentWord.chinese}
                                </div>
                                <div class="tone-info">
                                    üéµ Tones: ${currentWord.tone.map(t => TONES[t].name).join(', ')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="controls">
                        <button class="control-button nav-control" onclick="prevCard()">‚Äπ</button>
                        
                        <div class="center-controls">
                            <button class="action-button show-button" onclick="toggleAnswer()">
                                ${state.showAnswer ? 'üôà Hide' : 'üëÄ Show'}
                            </button>
                            ${state.showAnswer && !isMastered ? 
                                '<button class="action-button master-button" onclick="markAsMastered()">‚≠ê Master</button>' : ''}
                            <button class="action-button flip-button" onclick="flipQuizMode()">üîÑ</button>
                        </div>
                        
                        <button class="control-button nav-control" onclick="nextCard()">‚Ä∫</button>
                    </div>
                    
                    <div class="progress-info">
                        <div class="progress-card">
                            <span class="progress-text">
                                üìä Card ${state.currentCard + 1} of ${filteredVocab.length}
                            </span>
                            <div class="progress-bar-container">
                                <div class="progress-bar" style="width: ${((state.currentCard + 1) / filteredVocab.length) * 100}%"></div>
                            </div>
                        </div>
                        
                        ${state.selectedCategory === 'all' ? `
                            <button class="shuffle-button ${state.isShuffled ? 'shuffled' : ''}" onclick="shuffleCards()">
                                üîÄ ${state.isShuffled ? 'Shuffled!' : 'Shuffle Cards'}
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function renderTonePractice() {
            const currentWord = getCurrentWord();
            const filteredVocab = getFilteredVocab();
            
            return `
                <div class="card-container">
                    ${renderProgressStats()}
                    ${renderCategoryFilter()}
                    
                    <div class="flashcard tone-practice">
                        <div class="card-bg-emoji top-right">üéµ</div>
                        <div class="card-bg-emoji bottom-left">üéØ</div>
                        
                        <div class="card-content">
                            <div class="chinese-text">${currentWord.chinese}</div>
                            <div class="pinyin-text">${currentWord.pinyin}</div>
                            <div class="answer-text" style="background: #dbeafe; color: #374151;">${currentWord.english}</div>
                            <div class="category-tag ${CATEGORIES[currentWord.category].class}">
                                ${CATEGORIES[currentWord.category].emoji} ${currentWord.category}
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem; z-index: 10; position: relative;">
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; text-align: center; background: linear-gradient(to right, #059669, #0f766e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                                üéµ What tone(s) does this word use? ü§î
                            </h3>
                            <div class="tone-grid">
                                ${Object.entries(TONES).map(([toneNum, toneInfo]) => `
                                    <button class="tone-button ${
                                        state.selectedTone === parseInt(toneNum) 
                                            ? (currentWord.tone.includes(parseInt(toneNum)) ? 'correct' : 'incorrect') 
                                            : ''
                                    }" onclick="handleToneGuess(${toneNum})" ${state.selectedTone !== null ? 'disabled' : ''}>
                                        <div class="tone-number ${toneInfo.color}">
                                            ${toneNum === '0' ? 'üîÑ Neutral' : `${toneNum}Ô∏è‚É£ Tone ${toneNum}`}
                                        </div>
                                        <div class="tone-desc">${toneInfo.description}</div>
                                        <div class="tone-symbol">${toneInfo.symbol}</div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        
                        ${state.selectedTone !== null ? `
                            <div style="text-align: center; z-index: 10; position: relative;">
                                <div style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; background: #fef3c7; padding: 0.75rem 1rem; border-radius: 1rem;">
                                    ‚úÖ Correct tones: ${renderToneIndicator(currentWord.tone)}
                                </div>
                                <div style="font-size: 0.875rem; color: #6b7280; background: #f3f4f6; padding: 0.5rem 0.75rem; border-radius: 9999px;">
                                    ${currentWord.tone.map(t => TONES[t].name).join(', ')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="progress-info">
                        <div class="score-display">
                            <span class="score-text">
                                üéØ Score: <span style="color: #059669;">${state.score}</span>/<span style="color: #3b82f6;">${state.totalAnswered}</span>
                            </span>
                            ${state.studyStreak > 0 ? `<div class="streak-text">üî• Streak: ${state.studyStreak}</div>` : ''}
                        </div>
                        <div class="progress-card" style="background: linear-gradient(to right, #f3e8ff, #fce7f3); margin-top: 0.5rem;">
                            <span class="progress-text">
                                üìä Card ${state.currentCard + 1} of ${filteredVocab.length}
                            </span>
                            <div class="progress-bar-container">
                                <div class="progress-bar" style="background: linear-gradient(to right, #10b981, #059669); width: ${((state.currentCard + 1) / filteredVocab.length) * 100}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderSentences() {
            const currentSentenceData = BASIC_SENTENCES[state.currentSentence];
            
            return `
                <div style="max-width: 42rem; margin: 0 auto;">
                    <div class="flashcard sentences-card">
                        <div class="card-bg-emoji top-right">üí¨</div>
                        <div class="card-bg-emoji bottom-left">üåü</div>
                        
                        <div style="text-align: center; margin-bottom: 1.5rem; z-index: 10; position: relative;">
                            <div class="sentence-section">
                                <div class="sentence-chinese">${currentSentenceData.chinese}</div>
                            </div>
                            <div class="sentence-section pinyin">
                                <div class="sentence-pinyin">${currentSentenceData.pinyin}</div>
                            </div>
                            <div class="sentence-section english">
                                <div class="sentence-english">üí° ${currentSentenceData.english}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button class="control-button" style="background: linear-gradient(to right, #f97316, #ef4444);" onclick="prevSentence()">‚Äπ</button>
                        
                        <div style="text-align: center; background: white; border-radius: 1rem; padding: 0.75rem 1.5rem; box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);">
                            <div style="font-size: 1.125rem; font-weight: 600; color: #374151;">
                                üìù Sentence <span style="color: #f97316;">${state.currentSentence + 1}</span> of <span style="color: #ef4444;">${BASIC_SENTENCES.length}</span>
                            </div>
                            <div style="width: 8rem; background: #e5e7eb; border-radius: 9999px; height: 0.5rem; margin-top: 0.5rem; margin-left: auto; margin-right: auto;">
                                <div style="background: linear-gradient(to right, #f97316, #ef4444); height: 0.5rem; border-radius: 9999px; transition: all 0.3s; width: ${((state.currentSentence + 1) / BASIC_SENTENCES.length) * 100}%"></div>
                            </div>
                        </div>
                        
                        <button class="control-button" style="background: linear-gradient(to right, #f97316, #ef4444);" onclick="nextSentence()">‚Ä∫</button>
                    </div>
                </div>
            `;
        }

        function renderToneGuide() {
            return `
                <div class="tone-guide">
                    <h2 class="guide-title">üéµ Mandarin Tone Guide</h2>
                    
                    <div style="margin-bottom: 1.5rem;">
                        ${Object.entries(TONES).map(([toneNum, toneInfo]) => `
                            <div class="tone-entry border-${toneInfo.color}">
                                <div class="tone-header">
                                    <span class="tone-symbol-large ${toneInfo.color}">
                                        ${toneInfo.symbol}
                                    </span>
                                    <span class="tone-name">${toneInfo.name}</span>
                                    <span class="tone-number-small ${toneInfo.color}">
                                        ${toneNum === '0' ? '¬∑' : toneNum}
                                    </span>
                                </div>
                                <p class="tone-description">${toneInfo.description}</p>
                                
                                ${toneNum === '1' ? '<p class="tone-example">Example: Â¶à (mƒÅ) - mother | Keep your voice high and steady</p>' : ''}
                                ${toneNum === '2' ? '<p class="tone-example">Example: È∫ª (m√°) - hemp | Start low and rise like asking "Really?"</p>' : ''}
                                ${toneNum === '3' ? '<p class="tone-example">Example: È©¨ (m«é) - horse | Dip down then rise up</p>' : ''}
                                ${toneNum === '4' ? '<p class="tone-example">Example: È™Ç (m√†) - to scold | Start high and drop sharply</p>' : ''}
                                ${toneNum === '0' ? '<p class="tone-example">Example: Âêó (ma) - question particle | Quick and light</p>' : ''}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="pro-tips">
                        <h3 class="tips-title">
                            üìà üí° Pro Learning Tips:
                        </h3>
                        <ul class="tips-list">
                            <li>‚Ä¢ <strong>Practice with gestures:</strong> Use hand movements to follow tone patterns</li>
                            <li>‚Ä¢ <strong>Record yourself:</strong> Compare your pronunciation with native speakers</li>
                            <li>‚Ä¢ <strong>Learn tone pairs:</strong> Some combinations are more common than others</li>
                            <li>‚Ä¢ <strong>Context matters:</strong> Wrong tone = wrong word (mƒÅ vs m√° vs m«é vs m√†)</li>
                            <li>‚Ä¢ <strong>Start slow:</strong> Focus on accuracy before speed</li>
                            <li>‚Ä¢ <strong>Use tone marks:</strong> Always include them when writing pinyin</li>
                        </ul>
                    </div>
                    
                    <div class="practice-tip">
                        <h4 class="practice-title">üéØ Quick Practice:</h4>
                        <p class="practice-text">
                            Try saying "ma" in all four tones plus neutral: mƒÅ (mother), m√° (hemp), m«é (horse), m√† (scold), ma (question particle)
                        </p>
                    </div>
                </div>
            `;
        }

        // Event Handlers
        function setCategory(category) {
            state.selectedCategory = category;
            state.currentCard = 0;
            updateDisplay();
        }

        function nextCard() {
            const filteredVocab = getFilteredVocab();
            state.currentCard = (state.currentCard + 1) % filteredVocab.length;
            state.showAnswer = false;
            state.selectedTone = null;
            
            if (state.studySession.started) {
                state.studySession.wordsStudied++;
            } else {
                state.studySession = { started: true, wordsStudied: 1, timeStarted: Date.now() };
            }
            
            updateDisplay();
        }

        function prevCard() {
            const filteredVocab = getFilteredVocab();
            state.currentCard = (state.currentCard - 1 + filteredVocab.length) % filteredVocab.length;
            state.showAnswer = false;
            state.selectedTone = null;
            updateDisplay();
        }

        function toggleAnswer() {
            state.showAnswer = !state.showAnswer;
            updateDisplay();
        }

        function markAsMastered() {
            const currentWord = getCurrentWord();
            const wordIndex = state.selectedCategory === 'all' 
                ? (state.isShuffled ? state.shuffledCards[state.currentCard] : state.currentCard)
                : HSK1_VOCABULARY.findIndex(w => w === currentWord);
            
            state.masteredWords.add(wordIndex);
            nextCard();
        }

        function flipQuizMode() {
            state.quizMode = state.quizMode === 'chinese-to-english' ? 'english-to-chinese' : 'chinese-to-english';
            updateDisplay();
        }

        function shuffleCards() {
            const newShuffled = Array.from({length: HSK1_VOCABULARY.length}, (_, i) => i);
            for (let i = newShuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newShuffled[i], newShuffled[j]] = [newShuffled[j], newShuffled[i]];
            }
            state.shuffledCards = newShuffled;
            state.isShuffled = true;
            state.currentCard = 0;
            updateDisplay();
        }

        function handleToneGuess(tone) {
            state.selectedTone = parseInt(tone);
            const currentWord = getCurrentWord();
            const correctTones = currentWord.tone;
            
            if (correctTones.includes(parseInt(tone))) {
                state.score++;
                if (state.score > 0 && state.score % 5 === 0) {
                    state.studyStreak++;
                }
            }
            state.totalAnswered++;
            
            updateDisplay();
            
            setTimeout(() => {
                nextCard();
            }, 1500);
        }

        function nextSentence() {
            state.currentSentence = (state.currentSentence + 1) % BASIC_SENTENCES.length;
            updateDisplay();
        }

        function prevSentence() {
            state.currentSentence = (state.currentSentence - 1 + BASIC_SENTENCES.length) % BASIC_SENTENCES.length;
            updateDisplay();
        }

        function resetProgress() {
            state = {
                currentMode: state.currentMode,
                currentCard: 0,
                showAnswer: false,
                score: 0,
                totalAnswered: 0,
                currentSentence: 0,
                selectedTone: null,
                quizMode: 'chinese-to-english',
                selectedCategory: 'all',
                studyStreak: 0,
                masteredWords: new Set(),
                shuffledCards: Array.from({length: HSK1_VOCABULARY.length}, (_, i) => i),
                isShuffled: false,
                studySession: { started: false, wordsStudied: 0, timeStarted: null }
            };
            updateDisplay();
        }

        // Initialize the app
        window.onload = init;
    </script>
</body>
</html>
